AVbin
=====

:Home:       http://code.google.com/p/avbin
:Creator:    Alex Holkner <Alex.Holkner@gmail.com>
:Maintainer: Nathan Stocks <nathan.stocks@gmail.com>

Building
--------

AVbin is designed to be used with a particular version of FFmpeg.  This version
of FFmpeg is included in the AVbin project under the ``ffmpeg`` directory.  Note
that this version of FFmpeg may contain avbin-specific patches.  See the file
``ffmpeg/README.avbin`` for more details.

Use the included `build.sh` script to compile AVbin.  This takes care of
configuring FFmpeg correctly, compiling it, then linking it with the AVbin
sources.  The final AVbin libraries are placed in the ``dist`` directory.

To build on your platform, run...

    ./build.sh $TARGET

...where $TARGET is one of:

   linux-x86-32
   linux-x86-64
   darwin-x86-32
   darwin-x86-64
   win32
   win64

Run ``build.sh --help`` for more information.


Building on OS X Lion
---------------------

- Install Xcode (from Apple's App Store)
- Install yasm (You can install MacPorts and then run 'sudo port install yasm')


Cross-compiling for Win64 or Win32 on Linux
-------------------------------------------

Instructions are for Ubuntu 11.10 amd64

- Install MinGW-64: sudo apt-get install mingw-64
- Cross-compile zlib and install it:

  wget http://zlib.net/zlib-1.2.5.tar.gz
  tar zxvf zlib-1.2.5.tar.gz
  cd zlib-1.2.5
  make PREFIX=i686-w64-mingw32- -f win32/Makefile.gcc
  sudo make PREFIX=i686-w64-mingw32- LIBRARY_PATH=/usr/i686-w64-mingw32/lib \
    INCLUDE_PATH=/usr/i686-w64-mingw32/include/ BIN_PATH=/dev/null -f \
    win32/Makefile.gcc install

- Cross-compile bzlib and install it

  wget http://bzip.org/1.0.6/bzip2-1.0.6.tar.gz
  tar zxvf bzip2-1.0.6.tar.gz
  cd bzip2-1.0.6/
  make CC=i686-w64-mingw32-gcc AR=i686-w64-mingw32-ar \
    RANLIB=i686-w64-mingw32-ranlib PREFIX=/usr/i686-w64-mingw32 libbz2.a
  sudo cp libbz2.a /usr/i686-w64-mingw32/lib/
  sudo cp bzlib.h /usr/i686-w64-mingw32/include/

(If you will be creating a release distribution)
- Install 7-Zip: sudo apt-get install p7zip-full


Building on Win32
-----------------

- Install MinGW, MSYS using the MSYS installer.
- Install Git
- Download yasm win32 binary, from the yasm web site, rename it "yasm.exe" and
  place it in c:\MinGW\bin

(For distribution...)
- Download/Install 7-Zip in c:\7-Zip -- then add /c/7-Zip to the MinGW path.


Caveats
-------

AVbin is currently supported only on the following platforms

* Linux
  - x86
  - x86-64
* Mac OS X 10.6 - 10.7
  - x86
  - x86-64
* Windows XP, Vista, 7
  - x86
  - x86-64

The configuration scripts currently assume cross-compilation for Linux-x86-32. 
Minor changes should be needed to to compile on the target platform.  Patches 
for this or other platforms are welcome.

Darwin currently requires OS X 10.6 or greater.


Installation and usage
----------------------

Place the resulting avbin.so, avbin.dylib or avbin.dll from the ``dist``
directory into the appropriate system directory.

The AVbin dynamic library exports all of FFmpeg's functions from libavcodec,
libavutil and libavformat.  It also exports some higher-level functions which
have a fixed ABI (they will not change in incompatible ways in future
releases), documented in ``include/avbin.h``.


License
-------

Due to the linkage between AVbin and FFmpeg, AVbin must be licensed under the
LGPL or GPL.  Currently all GPL features of the FFmpeg configuration are
disabled, permitting LGPL use.

You should see the accompanying COPYING and COPYING.LESSER files for details.
In summary, you must note the usage of FFmpeg and AVbin within the
documentation of your application.  If you make changes to either library, you
must include the sources of these changes within your application.


Contributions
-------------

Original darwin-x86-64 and win64 builds contributed by Micah Richert.
