AVbin
=====

:Home:       http://avbin.github.com
:Maintainer: Nathan Stocks <nathan.stocks@gmail.com>


End-User Installation
---------------------

End-users should use the installers provided in the binary release.  That is one
of the benefits of a binary distribution, after all...


Developing
----------

AVbin is a C library folliwing standard conventions.

Clone the git repository:

  git clone https://github.com/AVbin/AVbin.git avbin

See the header file ``include/avbin.h`` and the online API documentation at
http://avbin.github.com/AVbin/Docs.html


Building
--------

If you are interested in testing, contributing code, or otherwise helping out,
we encourage you to join the Pyglet mailing list (AVbin was originally created
for the Pyglet project).  See http://pyglet.org/contribute.html

AVbin is designed to be used with a particular version of Libav.  This version
of Libav is included as a submodule of the AVbin project under the ``libav``
directory.  Note that this version of Libav may contain AVbin-specific patches,
though we try to get all patches accepted upstream.

Use the included `build.sh` script to compile AVbin.  This takes care of
configuring Libav correctly, compiling it, then linking it with the AVbin
sources.  The final AVbin libraries are placed in the ``dist`` directory.

To build on your platform, use the included ``build.sh`` script.  See
``build.sh --help`` for usage information.


Building on OS X Lion
---------------------

Tested on OS X Lion

- Install Xcode (from Apple's App Store)
- Install yasm (You can install MacPorts and then run 'sudo port install yasm')


Building on Linux
-----------------

(My setup worked out of the box.)


Building (cross-compiling) for Win64 or Win32 on Linux
------------------------------------------------------

Tested on Ubuntu 11.10 amd64 (later upgraded to 12.04 LTS amd64)

- Install MinGW-64: sudo apt-get install mingw-64
- Cross-compile zlib and install it:

  wget http://zlib.net/zlib-1.2.5.tar.gz
  tar zxvf zlib-1.2.5.tar.gz
  cd zlib-1.2.5
  make PREFIX=i686-w64-mingw32- -f win32/Makefile.gcc
  sudo make PREFIX=i686-w64-mingw32- LIBRARY_PATH=/usr/i686-w64-mingw32/lib \
    INCLUDE_PATH=/usr/i686-w64-mingw32/include/ BIN_PATH=/dev/null -f \
    win32/Makefile.gcc install

- Cross-compile bzlib and install it

  wget http://bzip.org/1.0.6/bzip2-1.0.6.tar.gz
  tar zxvf bzip2-1.0.6.tar.gz
  cd bzip2-1.0.6/
  make CC=i686-w64-mingw32-gcc AR=i686-w64-mingw32-ar \
    RANLIB=i686-w64-mingw32-ranlib PREFIX=/usr/i686-w64-mingw32 libbz2.a
  sudo cp libbz2.a /usr/i686-w64-mingw32/lib/
  sudo cp bzlib.h /usr/i686-w64-mingw32/include/

- Install 7-Zip: sudo apt-get install p7zip-full


Caveats
-------

AVbin is currently known to function on the following platforms

* Linux x86 (32- and 64-bit)

* Mac OS X 10.6 - 10.7 (32- and 64-bit)

* Windows XP (32-bit)

* Windows 7 (64-bit)


Installation and usage
----------------------

Place the resulting avbin.so, avbin.dylib or avbin.dll from the ``dist``
directory into the appropriate system directory.

The AVbin dynamic library exports all of Libav's functions from libavcodec,
libavutil and libavformat.  It also exports some higher-level functions which
have a fixed ABI (they will not change in incompatible ways in future
releases), documented in ``include/avbin.h``.


License
-------

Due to the linkage between AVbin and Libav, AVbin must be licensed under the
LGPL or GPL.  Currently all GPL features of the Libav configuration are
disabled, and AVbin is licensed under the LGPL.

You should see the accompanying COPYING and COPYING.LESSER files for details.
In summary, you must note the usage of AVbin within the documentation of your
application.  If you make changes to either library, you must either contribute
said changes upstream or include the sources of these changes within your
distributed application.


Contributions
-------------

Alex Holkner      - Original author, original maintainer
Micah Richert     - darwin-x86-64, win64 building
Anatoly Techtonik - C++ integration
